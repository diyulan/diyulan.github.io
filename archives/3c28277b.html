<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>小程序学习笔记 | Hi, 幽蓝</title><meta name="keywords" content="幽蓝, ulan, diyulan, H5, CSS3, JS, JavaScript"><meta name="author" content="幽蓝"><meta name="copyright" content="幽蓝"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="小程序特点 用户不需要下载安装，点开即用，用完即走，实现用户当前需求的工具 运行环境不同：网页运行在浏览器环境中，小程序运行在微信环境中 API不同：小程序无法调用DOM和BOM的API，但小程序可以调用微信环境提供的API，例如：地理位置、扫码、支付  项目结构 默认项目文件 pages：用来存放所有小程序页面，以单独文件夹存在 utils：用来存放工具性质的模块 app.js小程序项目的入口文">
<meta property="og:type" content="article">
<meta property="og:title" content="小程序学习笔记">
<meta property="og:url" content="https://diyulan.me/archives/3c28277b.html">
<meta property="og:site_name" content="Hi, 幽蓝">
<meta property="og:description" content="小程序特点 用户不需要下载安装，点开即用，用完即走，实现用户当前需求的工具 运行环境不同：网页运行在浏览器环境中，小程序运行在微信环境中 API不同：小程序无法调用DOM和BOM的API，但小程序可以调用微信环境提供的API，例如：地理位置、扫码、支付  项目结构 默认项目文件 pages：用来存放所有小程序页面，以单独文件夹存在 utils：用来存放工具性质的模块 app.js小程序项目的入口文">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://diyulan.me/img/cover_weChat.webp">
<meta property="article:published_time" content="2022-06-30T06:53:06.000Z">
<meta property="article:modified_time" content="2022-07-19T08:12:45.708Z">
<meta property="article:author" content="幽蓝">
<meta property="article:tag" content="幽蓝, ulan, diyulan, H5, CSS3, JS, JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://diyulan.me/img/cover_weChat.webp"><link rel="shortcut icon" href="/img/index_logo.webp"><link rel="canonical" href="https://diyulan.me/archives/3c28277b"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '小程序学习笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-19 16:12:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.1.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/index_avatar.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-mug-saucer"></i><span> 项目</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/284b2c05.html"><span> free练习题</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover_weChat.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Hi, 幽蓝</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa-solid fa-mug-saucer"></i><span> 项目</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/284b2c05.html"><span> free练习题</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">小程序学习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-30T06:53:06.000Z" title="发表于 2022-06-30 14:53:06">2022-06-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-19T08:12:45.708Z" title="更新于 2022-07-19 16:12:45">2022-07-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.7k</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="小程序学习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="小程序特点"><a href="#小程序特点" class="headerlink" title="小程序特点"></a>小程序特点</h1><ol>
<li>用户不需要下载安装，点开即用，用完即走，实现用户当前需求的工具</li>
<li>运行环境不同：网页运行在浏览器环境中，小程序运行在微信环境中</li>
<li>API不同：小程序无法调用DOM和BOM的API，但小程序可以调用微信环境提供的API，例如：地理位置、扫码、支付</li>
</ol>
<h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><ol>
<li>默认项目文件<ul>
<li>pages：用来存放所有小程序页面，以单独文件夹存在</li>
<li>utils：用来存放工具性质的模块</li>
<li>app.js小程序项目的入口文件</li>
<li>app.json：小程序项目的全局配置文件</li>
<li>app.wxss：小程序项目的全局样式文件</li>
<li>project.config.json：项目的配置文件</li>
<li>sitemap.json：用来配置小程序及其页面是否允许被微信索引</li>
</ul>
</li>
</ol>
<h1 id="常用组件"><a href="#常用组件" class="headerlink" title="常用组件"></a>常用组件</h1><ol>
<li>view：类似于HTML中的div，是一个块级元素</li>
<li>block：类似于Vue中的template，是一个占位符</li>
<li>scroll-view：滚动列表效果</li>
<li>swiper和swiper-item：轮播图容器组件和轮播图item组件</li>
<li>text：显示文字，selectable属性实现长按选中文本</li>
<li>rich-text：通过nodes属性把HTML字符串渲染为对应的UI结构<br><code>&lt;rich-text nodes=&quot;&lt;h1 style=&#39;color:lightcoral;&#39;&gt;标题&lt;/h1&gt;&quot;&gt;&lt;/rich-text&gt;</code></li>
<li>button：按钮组件，通过open-type属性可以调用微信提供的各种功能</li>
<li>image：图片组件，mode属性用来指定图片的裁剪和缩放模式；默认宽300px，高240px</li>
</ol>
<h1 id="样式介绍"><a href="#样式介绍" class="headerlink" title="样式介绍"></a>样式介绍</h1><h2 id="rpx尺寸单位"><a href="#rpx尺寸单位" class="headerlink" title="rpx尺寸单位"></a>rpx尺寸单位</h2><ol>
<li>rpx是微信小程序独有的，用来解决屏幕适配的尺寸单位；实现原理rpx把所有设备的屏幕，在宽度上等分为750份（当前屏幕总宽度为750rpx）</li>
<li>rpx与px之间的单位换算，比如：屏幕宽度为375px，共有750物理像素，等分750rpx<ul>
<li>750rpx &#x3D; 375px &#x3D; 750物理像素</li>
<li>1rpx &#x3D; 0.5px &#x3D; 1物理像素</li>
</ul>
</li>
</ol>
<table>
<thead>
<tr>
<th>设备</th>
<th>rpx换算px（屏幕宽度&#x2F;750）</th>
<th>px换算rpx（750&#x2F;屏幕宽度）</th>
</tr>
</thead>
<tbody><tr>
<td>iPhone5</td>
<td>1rpx &#x3D; 0.42px</td>
<td>1px &#x3D; 2.34rpx</td>
</tr>
<tr>
<td>iPhone6</td>
<td>1rpx &#x3D; 0.5px</td>
<td>1px &#x3D; 2rpx</td>
</tr>
<tr>
<td>iPhone6 Plus</td>
<td>1rpx &#x3D; 0.552px</td>
<td>1px &#x3D; 1.81rpx</td>
</tr>
</tbody></table>
<ol start="3">
<li>官方建议：开发微信小程序时，设计师可以用iPhone6作为视觉稿的标准</li>
</ol>
<h2 id="导入样式"><a href="#导入样式" class="headerlink" title="导入样式"></a>导入样式</h2><p>例如：根目录下创建common公共样式，然后在index.wxss导入common.wxss<br><img src="/img/content_commonStyle.webp"></p>
<h2 id="全局样式"><a href="#全局样式" class="headerlink" title="全局样式"></a>全局样式</h2><p>根目录有个app.wxss文件，是专门用来写全局样式，不需要导入</p>
<h2 id="局部样式"><a href="#局部样式" class="headerlink" title="局部样式"></a>局部样式</h2><p>页面的.wxss文件中定义的样式为局部样式，只作用于当前页面</p>
<h1 id="修改data值"><a href="#修改data值" class="headerlink" title="修改data值"></a>修改data值</h1><p>看起来很像vue，但又有点不一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt;数字：&#123;&#123;count&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;button type=&quot;primary&quot; bindtap=&quot;changeCount&quot;&gt;点击修改&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">data: &#123;</span><br><span class="line">  count: 1</span><br><span class="line">&#125;,</span><br><span class="line">changeCount()&#123;</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    count: this.data.count + 1</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h1><h2 id="常用事件"><a href="#常用事件" class="headerlink" title="常用事件"></a>常用事件</h2><ol>
<li>bindtap：类似于vue中的@click，在微信里与data数据同一层</li>
<li>bindinput：用来获取输入框中的文本，通过<code>e.detail.value</code>获取文本数据</li>
</ol>
<h2 id="事件传参"><a href="#事件传参" class="headerlink" title="事件传参"></a>事件传参</h2><ol>
<li>小程序中的事件传参比较特殊，不能在绑定事件同时为事件处理函数传递参数；bindtap属性无法传值，相当于调用名称为btnhandler(123)的事件处理函数<br><code>&lt;button bindtap=&quot;btnhandler(123)&quot;&gt;事件传参&lt;/button&gt;</code></li>
<li>组件提供data-xxx自定义属性传参，其中xxx表示参数名；info会被解析为参数名，数值2会被解析为参数值<br><code>&lt;button bindtap=&quot;btnHandler&quot; data-info=&quot;&#123;&#123;2&#125;&#125;&quot;&gt;事件传参&lt;/button&gt;</code></li>
<li>在事件处理函数中，通过<span style="color: red">e.target.dataset.参数名</span>即可获取到具体参数的值<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;button type=&quot;primary&quot; bindtap=&quot;btnHandler&quot; data-info=&quot;&#123;&#123;2&#125;&#125;&quot;&gt;事件传参&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">btnHandler(e)&#123;</span><br><span class="line">  console.log(e.target.dataset.info)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="获取文本数据"><a href="#获取文本数据" class="headerlink" title="获取文本数据"></a>获取文本数据</h2><ol>
<li>bindinput输入文本时触发，通过<code>e.detail.value</code>获取文本数据<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; bindinput=&quot;inputHandler&quot;/&gt;</span><br><span class="line"></span><br><span class="line">inputHandler(e)&#123;</span><br><span class="line">  console.log(e.detail.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>绑定data数据，输入文本的同时修改data数据；value默认值动态绑定msg，输入文本时触发inputHandler方法，msg修改成文本内容<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input value=&quot;&#123;&#123;msg&#125;&#125;&quot; bindinput=&quot;inputHandler&quot;/&gt;</span><br><span class="line"></span><br><span class="line">data: &#123;</span><br><span class="line">  msg: &#x27;Hi, &#x27;</span><br><span class="line">&#125;,</span><br><span class="line">inputHandler(e)&#123;</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    msg: e.detail.value</span><br><span class="line">  &#125;)</span><br><span class="line">  console.log(this.data.msg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h1><ol>
<li>使用<code>wx:if=&quot;&#123;&#123;condition&#125;&#125;&quot;</code>来判断是否需要渲染该代码块<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:if=&quot;&#123;&#123;sex === 1&#125;&#125;&quot;&gt;男&lt;/view&gt;</span><br><span class="line">&lt;view wx:elif=&quot;&#123;&#123;sex === 2&#125;&#125;&quot;&gt;女&lt;/view&gt;</span><br><span class="line">&lt;view wx:else&gt;保密&lt;/view&gt;</span><br></pre></td></tr></table></figure></li>
<li>block标签是占位符，不显示在页面中，实现多个组件显示隐藏<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;block wx:if=&quot;&#123;&#123;true&#125;&#125;&quot;&gt;</span><br><span class="line">  &lt;view&gt;你好&lt;/view&gt;</span><br><span class="line">  &lt;view&gt;幽蓝&lt;/view&gt;</span><br><span class="line">&lt;/block&gt;</span><br></pre></td></tr></table></figure></li>
<li>hidden属性类似v-show，同样起到显示隐藏效果，它和if区别在于生成原理上不同，if是动态创建或移除元素，hidden是切换样式(display:none&#x2F;block)控制元素显示隐藏，频繁切换hidden性能更好<br><code>&lt;view hidden=&quot;&#123;&#123;true&#125;&#125;&quot;&gt;条件为true隐藏，条件为false显示&lt;/view&gt;</code></li>
</ol>
<h1 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h1><ol>
<li>wx:for循环渲染组件，默认item表示项的值，index表示索引<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:for=&quot;&#123;&#123;brand&#125;&#125;&quot;&gt;</span><br><span class="line">  品牌：&#123;&#123;item&#125;&#125;，索引：&#123;&#123;index&#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">data: &#123;</span><br><span class="line">  brand: [&#x27;苹果&#x27;, &#x27;华为&#x27;, &#x27;小米&#x27;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>修改默认item、index名字<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:for=&quot;&#123;&#123;brand&#125;&#125;&quot; wx:for-item=&quot;value&quot; wx:for-index=&quot;i&quot;&gt;</span><br><span class="line">  品牌：&#123;&#123;value&#125;&#125;，索引：&#123;&#123;i&#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure></li>
<li>wx:key用来提高wx:for渲染性能，vue中不写:key会报错，小程序中不写wx:key会报警告<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;view wx:for=&quot;&#123;&#123;brand&#125;&#125;&quot; wx:key=&quot;index&quot;&gt;</span><br><span class="line">  品牌：&#123;&#123;item.name&#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">data: &#123;</span><br><span class="line">  brand: [</span><br><span class="line">    &#123;name: &#x27;华为&#x27;&#125;,</span><br><span class="line">    &#123;name: &#x27;小米&#x27;&#125;,</span><br><span class="line">    &#123;name: &#x27;魅族&#x27;&#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="全局配置"><a href="#全局配置" class="headerlink" title="全局配置"></a>全局配置</h1><h2 id="app-json"><a href="#app-json" class="headerlink" title="app.json"></a>app.json</h2><ol>
<li>根目录app.json文件是小程序的全局配置文件，常用配置项：<ul>
<li>pages：记录当前小程序所有页面的存放路径</li>
<li>window：全局设置小程序窗口的外观</li>
<li>tabBar：设置小程序底部的tabBar效果</li>
<li>style：是否启动新版的组件样式</li>
</ul>
</li>
</ol>
<h2 id="window常用配置项"><a href="#window常用配置项" class="headerlink" title="window常用配置项"></a>window常用配置项</h2><table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>navigationBarTitleText</td>
<td>Weixin</td>
<td>导航栏标题文字内容</td>
</tr>
<tr>
<td>navigationBarBackgroundColor</td>
<td>#fff</td>
<td>导航栏背景颜色</td>
</tr>
<tr>
<td>navigationBarTextStyle</td>
<td>black</td>
<td>导航栏标题颜色，仅支持black &#x2F; white</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>#fff</td>
<td>下拉窗口的背景色</td>
</tr>
<tr>
<td>backgroundTextStyle</td>
<td>dark</td>
<td>下拉loading的样式，仅支持dark &#x2F; light</td>
</tr>
<tr>
<td>enablePullDownRefresh</td>
<td>false</td>
<td>是否全局开启下拉刷新</td>
</tr>
<tr>
<td>onReachBottomDistance</td>
<td>50</td>
<td>页面上拉触底事件触发时距页面底部距离，单位为px</td>
</tr>
</tbody></table>
<h2 id="tabBar"><a href="#tabBar" class="headerlink" title="tabBar"></a>tabBar</h2><ol>
<li><p>tabBar用于多页面快速切换，类似早期智能手机的底部栏，有返回、首页、后台等按钮；tabBar中只能配置2～5tab页签；渲染顶部tabBar时，不显示icon，只显示文本</p>
</li>
<li><p>tabBar6个组成部分</p>
<ul>
<li>backgroundColor：tabBar的背景色</li>
<li>borderStyle：tabBar上边框的颜色</li>
<li>selectedIconPath：选中时的图片路径</li>
<li>iconPath：未选中时的图片路径</li>
<li>selectedColor：tab上的文字选中时的颜色</li>
<li>color：tab上文字的默认（未选中）颜色</li>
</ul>
</li>
<li><p>tabBar配置项</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>position</td>
<td>bottom</td>
<td>tabBar的位置，仅支持bottom &#x2F; top</td>
</tr>
<tr>
<td>borderStyle</td>
<td>black</td>
<td>tabBar的上边框的颜色，仅支持black &#x2F; white</td>
</tr>
<tr>
<td>color</td>
<td></td>
<td>tab上文字的默认（未选中）颜色</td>
</tr>
<tr>
<td>selectedColor</td>
<td></td>
<td>tab上文字选中时颜色</td>
</tr>
<tr>
<td>backgroundColor</td>
<td></td>
<td>tabBar的背景色</td>
</tr>
<tr>
<td>list</td>
<td></td>
<td>必填，标签页的列表，2～5个tab页签</td>
</tr>
</tbody></table>
</li>
<li><p>tab项配置选项</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>position</td>
<td>必填，页面路径，页面必须在pages中预先定义</td>
</tr>
<tr>
<td>borderStyle</td>
<td>必填，tab上显示的文字</td>
</tr>
<tr>
<td>color</td>
<td>未选中时的图标路径；当postion为top时，不显示icon</td>
</tr>
<tr>
<td>selectedColor</td>
<td>选中时的图标路径；当postion为top时，不显示icon</td>
</tr>
</tbody></table>
</li>
<li><p>tabBar写法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;pages&quot;:[</span><br><span class="line">    &quot;pages/index/index&quot;,</span><br><span class="line">    &quot;pages/test/test&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;tabBar&quot;: &#123;</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;pagePath&quot;: &quot;pages/index/index&quot;,</span><br><span class="line">        &quot;text&quot;: &quot;index&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;pagePath&quot;: &quot;pages/test/test&quot;,</span><br><span class="line">        &quot;text&quot;: &quot;test&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>tabBar想要展示的页面，必须放在pages数组内的顶部，否则会显示失败</p>
</blockquote>
</li>
</ol>
<h1 id="页面配置"><a href="#页面配置" class="headerlink" title="页面配置"></a>页面配置</h1><ol>
<li>页面配置个人称它为局部配置，新生成的页面，文件夹自带.json文件，它是当前页面设置局部配置的地方</li>
<li>常用配置项<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>navigationBarBackgroundColor</td>
<td>#000</td>
<td>当前页面导航栏背景颜色，如#000</td>
</tr>
<tr>
<td>navigationBarTextStyle</td>
<td>black</td>
<td>当前页面导航栏标题颜色，仅支持black&#x2F;white</td>
</tr>
<tr>
<td>navigationBarTitleText</td>
<td></td>
<td>当前页面导航栏标题文字内容</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>#fff</td>
<td>当前页面下拉窗口的背景色</td>
</tr>
<tr>
<td>backgroundTextStyle</td>
<td>dark</td>
<td>当前页面下拉loading的样式，仅支持dark&#x2F;light</td>
</tr>
<tr>
<td>enablePullDownRefresh</td>
<td>false</td>
<td>是否为当前页面开启下拉刷新的效果</td>
</tr>
<tr>
<td>onReachBottomDistance</td>
<td>50</td>
<td>页面上拉触底时间触发时距页面底部距离，单位为px</td>
</tr>
</tbody></table>
</li>
</ol>
<h1 id="数据请求"><a href="#数据请求" class="headerlink" title="数据请求"></a>数据请求</h1><h2 id="网络数据请求的限制"><a href="#网络数据请求的限制" class="headerlink" title="网络数据请求的限制"></a>网络数据请求的限制</h2><ol>
<li>出于安全性方面的考虑，小程序官方对数据接口的请求做出如下两个限制：<ul>
<li>只能请求HTTPS类型的接口</li>
<li>必须将接口的域名添加到信任列表中</li>
</ul>
</li>
<li>配置request合法域名：登入微信小程序管理后台 &gt; 开发 &gt; 开发设置 &gt; 服务器域名 &gt; 修改request<ul>
<li>域名只支持https协议</li>
<li>域名不能使用IP地址或localhost</li>
<li>域名必须经过ICP备案</li>
<li>服务器域名一个月内最多可申请5次修改</li>
</ul>
</li>
</ol>
<h2 id="发送get请求"><a href="#发送get请求" class="headerlink" title="发送get请求"></a>发送get请求</h2><p>调用微信小程序提供的wx.request()方法，示例代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wx.request(&#123;</span><br><span class="line">  url: &#x27;https://www.xxxxx.com/api/get&#x27;, // 请求的接口地址，必须基于https协议</span><br><span class="line">  method: &#x27;GET&#x27;,</span><br><span class="line">  data: &#123; // 发送到服务器的数据</span><br><span class="line">    name: &#x27;ulan&#x27;,</span><br><span class="line">    age: 9</span><br><span class="line">  &#125;,</span><br><span class="line">  success: (res) =&gt; &#123; // 请求成功之后的回调函数</span><br><span class="line">    console.log(res)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="发送post请求"><a href="#发送post请求" class="headerlink" title="发送post请求"></a>发送post请求</h2><p>修改上面method为post请求即可<code>method: &#39;POST&#39;</code></p>
<h2 id="页面刚加载时请求数据"><a href="#页面刚加载时请求数据" class="headerlink" title="页面刚加载时请求数据"></a>页面刚加载时请求数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 生命周期函数，监听页面加载</span><br><span class="line">onLoad()&#123;</span><br><span class="line">  this.getInfo()</span><br><span class="line">  this.postInfo()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getInfo()&#123;...&#125;</span><br><span class="line">postInfo()&#123;...&#125;</span><br></pre></td></tr></table></figure>

<h2 id="关于跨域和Ajax"><a href="#关于跨域和Ajax" class="headerlink" title="关于跨域和Ajax"></a>关于跨域和Ajax</h2><ol>
<li>跨域问题只存在于浏览器，由于小程序宿主环境是微信客户端，所以小程序不存在跨域问题</li>
<li>Ajax的核心依赖于浏览器中的XMLHttpRequest这个对象，由于小程序宿主环境是微信客户端，所以小程序不能叫做”发起Ajax请求”，而是叫做”发起网络数据请求”。</li>
</ol>
<h1 id="页面导航"><a href="#页面导航" class="headerlink" title="页面导航"></a>页面导航</h1><ol>
<li>声明式导航：声明一个<navigator>导航组件，点击<navigator>组件实现页面跳转</li>
<li>编程式导航：调用小程序的导航API</li>
</ol>
<h2 id="声明式导航"><a href="#声明式导航" class="headerlink" title="声明式导航"></a>声明式导航</h2><ol>
<li>navigator组件跳转到指定的tabBar页面时，需要指定url属性和open-type属性<ul>
<li>url表示要跳转的页面的地址，必须以&#x2F;开头</li>
<li>open-type表示跳转的方式，必须为switchTab<br><code>&lt;navigator url=&quot;/pages/index/index&quot; open-type=&quot;switchTab&quot;&gt;导航到主页面&lt;/navigator&gt;</code></li>
</ul>
</li>
<li>navigator组件跳转到非tabBar页面，操作跟上面相同，只不过open-type需要改成navigate<br><code>&lt;navigator url=&quot;/pages/log/log&quot; open-type=&quot;navigate&quot;&gt;导航到log页面&lt;/navigator&gt;</code><blockquote>
<p>为了简便，导航到非tabBar页面，open-type&#x3D;”navigate”属性可以省略</p>
</blockquote>
</li>
<li>navigator后退页面，open-type指定navigateBack，delta后退的层级<br><code>&lt;navigator open-type=&quot;bavigateBack&quot; delta=&quot;1&quot;&gt;后退&lt;/navigator&gt;</code><blockquote>
<p>为了简便，如果只是后退到上一页面，可以省略delta属性，因为默认值就是1</p>
</blockquote>
</li>
</ol>
<h2 id="编程式导航"><a href="#编程式导航" class="headerlink" title="编程式导航"></a>编程式导航</h2><ol>
<li>wx.switchTab方法的属性<ul>
<li>url：需要跳转的tabBar页面路径，路径后不能带参数</li>
<li>success：接口调用成功的回调函数</li>
<li>fail：接口调用失败的回调函数</li>
<li>complete：接口调用结束的回调函数（成功、失败都会执行）</li>
</ul>
</li>
</ol>
<p>1.1 导航到tabBar页面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;button bindtap=&quot;gotoIndex&quot;&gt;跳转到主页&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">gotoIndex()&#123;</span><br><span class="line">  wx.switchTab(&#123;</span><br><span class="line">    url: &#x27;/pages/index/index&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>wx.navigateTo方法的属性<ul>
<li>url：需要跳转的tabBar页面路径，路径后不能带参数</li>
<li>success：接口调用成功的回调函数</li>
<li>fail：接口调用失败的回调函数</li>
<li>complete：接口调用结束的回调函数（成功、失败都会执行）</li>
</ul>
</li>
</ol>
<p>2.1 导航到非tabBar页面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;button bindtap=&quot;gotoLog&quot;&gt;跳转到log页面&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">gotoLog()&#123;</span><br><span class="line">  wx.navigateTo(&#123;</span><br><span class="line">    url: &#x27;/pages/log/log&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>wx.navigateBack方法的属性<ul>
<li>delta：默认值1，返回的页面数，如果delta大于现有页面数，则返回到首页</li>
<li>success：接口调用成功的回调函数</li>
<li>fail：接口调用失败的回调函数</li>
<li>complete：接口调用结束的回调函数（成功、失败都会执行）</li>
</ul>
</li>
</ol>
<p>3.1 后退导航</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;button bindtap=&quot;gotoBack&quot;&gt;后退&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">gotoBack()&#123;</span><br><span class="line">  wx.navigateBack()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="导航传参"><a href="#导航传参" class="headerlink" title="导航传参"></a>导航传参</h2><ol>
<li><p>声明式导航传参</p>
<ul>
<li>参数与路径之间使用?分隔</li>
<li>参数键与参数值用&#x3D;相连</li>
<li>不同参数用&amp;分隔<br><code>&lt;navigator url=&quot;/pages/index/index?name=ulan&amp;age=9&quot;&gt;跳转到主页面&lt;/navigator&gt;</code><br>说明：跳转到主页面，通过?分隔参数，传递name和age</li>
</ul>
</li>
<li><p>编程式导航传参：调用wx.navigateTo()方法跳转页面携带参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;button bindtap=&quot;gotoIndex&quot;&gt;跳转到主页面&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">gotoIndex()&#123;</span><br><span class="line">  wx.navigateTo(&#123;</span><br><span class="line">    url: &#x27;/pages/index/index?name=ulan&amp;age=9&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>onLoad事件接收参数，options用来接收参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">  // 用来存放参数</span><br><span class="line">  query: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 生命周期函数——监听页面加载</span><br><span class="line">onLoad(options)&#123;</span><br><span class="line">  console.log(options)  // &#123;name: &quot;ulan&quot;, age: 9&#125;</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    query: options</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="页面事件"><a href="#页面事件" class="headerlink" title="页面事件"></a>页面事件</h1><h2 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h2><ol>
<li><p>启动下拉刷新两种方式</p>
<ul>
<li>全局：app.json的window节点，将enablePullDownRefresh设置为true</li>
<li>局部：页面的.json配置文件中，将enablePullDownRefresh设置为true<blockquote>
<p>实际开发中，推荐使用第2种方式，为需要的页面单独开启下拉刷新</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;usingComponents&quot;: &#123;&#125;,</span><br><span class="line">  &quot;enablePullDownRefresh&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>全局或局部.json配置文件中，通过backgroundColor和backgroundTextStyle来配置样式</p>
<ul>
<li>backgroundColor：窗口的背景颜色，仅支持16进制的颜色值</li>
<li>backgroundTextStyle：loading的样式，仅支持dark和light<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;usingComponents&quot;: &#123;&#125;,</span><br><span class="line">  &quot;enablePullDownRefresh&quot;: true,</span><br><span class="line">  &quot;backgroundColor&quot;: &quot;#efefef&quot;,</span><br><span class="line">  &quot;backgroundTextStyle&quot;: &quot;dark&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>onPullDownRefresh监听页面的下拉刷新事件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;view&gt;数字：&#123;&#123;count&#125;&#125;&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">data: &#123;</span><br><span class="line">  count: 9</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面相关事件处理函数，监听用户下拉动作</span><br><span class="line">onPullDownRefresh()&#123;</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    count: 0</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>当处理完下拉刷新后，loading效果会一直显示，不会主动消失。调用wx.stopPullDownRefresh()可以停止当前页面的下拉刷新。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">onPullDownRefresh()&#123;</span><br><span class="line">  this.setData(&#123;</span><br><span class="line">    count: 0</span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line">  // 放在最后，当上面指令完成后，停止刷新效果</span><br><span class="line">  wx.stopPullDownRefresh()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="上拉触底"><a href="#上拉触底" class="headerlink" title="上拉触底"></a>上拉触底</h2><ol>
<li>上拉触底是移动端专有名词，通过手指在屏幕上的上拉滑动操作，加载更多数据的行为</li>
<li>onReachBottom()监听当前页面的上拉触底事件，想看到效果，最好页面很长有滚动条<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onReachBottom()&#123;</span><br><span class="line">  console.log(&#x27;触发了上拉触底的事件&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>默认触底距离是50px，容易频繁触发上拉触底事件，可在全局或页面的.json配置文件中，通过onReachBottomDistance属性配置上拉触底距离<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;usingComponents&quot;: &#123;&#125;,</span><br><span class="line">  &quot;onReachBottomDistance&quot;: 150</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h1><h2 id="生命周期分类"><a href="#生命周期分类" class="headerlink" title="生命周期分类"></a>生命周期分类</h2><ol>
<li>应用生命周期函数<ul>
<li>onLauch(options){}：小程序初始化完成时，全局只触发一次</li>
<li>onShow(options){}：小程序启动或从后台进入前台显示时触发</li>
<li>onHide(){}：小程序从前台进入后台时触发</li>
</ul>
</li>
<li>页面生命周期函数<ul>
<li>onLoad(options){}：监听页面加载，一个页面只调用一次</li>
<li>onSHow(){}：监听页面显示</li>
<li>onReady(){}：监听页面初次渲染完成，一个页面只调用一次</li>
<li>onHide(){}：监听页面隐藏</li>
<li>onUnload(){}：监听页面卸载，一个页面只调用一次</li>
</ul>
</li>
</ol>
<h1 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h1><h2 id="组件的引用方式"><a href="#组件的引用方式" class="headerlink" title="组件的引用方式"></a>组件的引用方式</h2><ol>
<li>组件的引用方式分两种：<ul>
<li>局部引用：只能在当前被引用的页面内使用</li>
<li>全局引用：可以在每个小程序页面中使用<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 在页面的.json文件中，引入组件</span><br><span class="line">&#123;</span><br><span class="line">  &quot;usingComponents&quot;: &#123;</span><br><span class="line">    &quot;my-test&quot;: &quot;/components/test/test&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 在页面的.wxml文件中，使用组件</span><br><span class="line">&lt;my-test&gt;&lt;/my-test&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="组件和页面的不同点"><a href="#组件和页面的不同点" class="headerlink" title="组件和页面的不同点"></a>组件和页面的不同点</h2><ol>
<li>组件的.json文件中需要声明<code>&quot;component&quot;: true</code>属性</li>
<li>组件的.js文件中调用的是<code>Component()</code>函数</li>
<li>组件的事件处理函数需要定义到<code>methods</code>节点中</li>
</ol>
<h2 id="组件样式隔离"><a href="#组件样式隔离" class="headerlink" title="组件样式隔离"></a>组件样式隔离</h2><ol>
<li>组件样式隔离：组件A的样式不会影响到组件B，同样不会影响到页面，反之页面的样式不会影响到其他组件</li>
<li>只有class选择器具有隔离效果，其他选择器不受样式隔离的影响</li>
</ol>
<h2 id="data数据、methods方法"><a href="#data数据、methods方法" class="headerlink" title="data数据、methods方法"></a>data数据、methods方法</h2><ol>
<li>定义data数据和methods方法，类似vue写法呢<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    count: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 事件处理函数</span><br><span class="line">    addCount()&#123;</span><br><span class="line">      this.setData(&#123; count: this.data.count + 1 &#125;)</span><br><span class="line">      // 调用自定义方法</span><br><span class="line">      this._showCount()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 自定义方法建议以_开头</span><br><span class="line">    _showCount()&#123;</span><br><span class="line">      wx.showToast(&#123;</span><br><span class="line">        title: &#x27;count值为：&#x27; + this.data.count,</span><br><span class="line">        icon: &#x27;none&#x27;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="properties接收传递数据"><a href="#properties接收传递数据" class="headerlink" title="properties接收传递数据"></a>properties接收传递数据</h2><ol>
<li>properties用来接收外界传递到组件中的数据<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  // 属性定义</span><br><span class="line">  properties: &#123;</span><br><span class="line">    max: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      // 属性默认值</span><br><span class="line">      value: 10</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 如果传递max为9，默认值10会被覆盖</span><br><span class="line">&lt;my-test max=&quot;9&quot;&gt;&lt;/my-test&gt;</span><br></pre></td></tr></table></figure></li>
<li>data和properties，两者数据都存在同一个对象上，且都是可读可写，为了更好管理数据，咱们人为给它们进行区分<ul>
<li>data更倾向于存储组件的私有数据</li>
<li>properties更倾向于存储外界传递到组件中的数据<br><code>console.log(this.data === this.properties)  // true</code></li>
</ul>
</li>
</ol>
<h2 id="observers数据监听器"><a href="#observers数据监听器" class="headerlink" title="observers数据监听器"></a>observers数据监听器</h2><ol>
<li>observers用来监听和响应任何属性和数据字段的变化，从而执行特定的操作；类似于vue中的watch侦听器<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 组件的UI结构</span><br><span class="line">&lt;view&gt;&#123;&#123;n1&#125;&#125; + &#123;&#123;n2&#125;&#125; = &#123;&#123;sum&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;button size=&quot;mini&quot; bindtap=&quot;addN1&quot;&gt;n1自增&lt;/button&gt;</span><br><span class="line">&lt;button size=&quot;mini&quot; bindtap=&quot;addN2&quot;&gt;n2自增&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">Component(&#123;</span><br><span class="line">  data: &#123; n1: 0, n2: 0, sum: 0 &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    addN1()&#123; this.setData(&#123; n1: this.data.n1 + 1 &#125;)&#125;,</span><br><span class="line">    addN2()&#123; this.setData(&#123; n2: this.data.n2 + 1 &#125;)&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  // 数据监听节点</span><br><span class="line">  observers: &#123;</span><br><span class="line">    &#x27;n1, n2&#x27;(n1, n2)&#123;</span><br><span class="line">      this.setData(&#123; sum: n1 + n2 &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>如果某个对象需要被监听的属性太多，可以使用通配符**来监听对象中所以属性的变化<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    rgb: &#123;</span><br><span class="line">      r: 0,</span><br><span class="line">      g: 0,</span><br><span class="line">      b: 0</span><br><span class="line">    &#125;,</span><br><span class="line">    fullColor: &#x27;0, 0, 0&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  observers: &#123;</span><br><span class="line">    &#x27;rgb.**&#x27;(obj)&#123;</span><br><span class="line">      this.setData(&#123;</span><br><span class="line">        fullColor: `$&#123;obj.r&#125;, $&#123;obj.g&#125;, $&#123;obj.b&#125;`</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="纯数据字段"><a href="#纯数据字段" class="headerlink" title="纯数据字段"></a>纯数据字段</h2><ol>
<li>有些情况下，某些data中的字段（包括setData设置的字段）既不会展示在界面上，也不会传递给其他组件，仅仅在当前组件内部使用</li>
<li>此时，可以指定这样的数据字段为”纯数据字段”，它们将仅仅被记录在this.data中，而不参与任何界面渲染过程，这样有助于提升页面更新性能<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    // 将rgb改造为以_开头的纯数据字段</span><br><span class="line">    _rgb: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  // 指定所有_开头的数据字段为纯数据字段</span><br><span class="line">  observers: &#123;</span><br><span class="line">    pureDataPattern: /^_/</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="组件生命周期"><a href="#组件生命周期" class="headerlink" title="组件生命周期"></a>组件生命周期</h2><ol>
<li>组件全部生命周期函数<ul>
<li>created：组件刚创建好时执行</li>
<li>attached：组件被挂载到页面未渲染时执行</li>
<li>ready：组件渲染完成后执行</li>
<li>moved：组件移动到另一个位置时执行</li>
<li>detached：组件被删除时执行</li>
<li>error：组件报错时执行</li>
</ul>
</li>
<li>created：此时还不能调用setData，通常给组件的this添加一些自定义的属性字段</li>
<li>attached：此时this.data已被初始化完毕，可以进行一些初始化工作（例如发送请求，获取初始数据）</li>
<li>detached：退出一个页面时，触发组件的detached生命周期函数；适合做一些清理性质的工作<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  lifetimes: &#123;</span><br><span class="line">    created()&#123;&#125;,</span><br><span class="line">    attached()&#123;&#125;,</span><br><span class="line">    detached()&#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="组件所在的页面生命周期"><a href="#组件所在的页面生命周期" class="headerlink" title="组件所在的页面生命周期"></a>组件所在的页面生命周期</h2><ol>
<li>自定义组件的行为依赖于页面状态的变化，此时就需要用到组件所在页面的生命周期</li>
<li>比如你有两个页面，分别是主页和log页，主页设置好show和hide，默认进入主页执行show生命周期函数，切换到log页执行hide生命周期函数<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">  pageLifetimes: &#123;</span><br><span class="line">    show()&#123;&#125;, // 页面被展示</span><br><span class="line">    hide()&#123;&#125;, // 页面被隐藏</span><br><span class="line">    resize(size)&#123;&#125;  //页面尺寸变化</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="组件插槽"><a href="#组件插槽" class="headerlink" title="组件插槽"></a>组件插槽</h2><ol>
<li>换个思维来理解，组件插槽类似于电源插座，不确定你以后会使用什么电子设备，总之先占个坑</li>
<li>默认每个组件只允许使用一个<slot>进行占位，默认只支持单个插槽<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 组件导入后，取名为my-test</span><br><span class="line">&lt;view&gt;</span><br><span class="line">  &lt;view&gt;这是组件的内部节点&lt;/view&gt;</span><br><span class="line">  &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">// index.wxml页面</span><br><span class="line">&lt;my-test&gt;</span><br><span class="line">  &lt;view&gt;这是插入到组件slot中的内容&lt;/view&gt;</span><br><span class="line">&lt;/my-test&gt;</span><br></pre></td></tr></table></figure></li>
<li>启用多个插槽<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 组件的.js文件</span><br><span class="line">Component(&#123;</span><br><span class="line">  options: &#123;</span><br><span class="line">    multipleSlots: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>自定义插槽，我希望不同插槽显示不同内容，可以使用name属性命名，引入时使用slot属性<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 组件导入后，取名为my-test</span><br><span class="line">&lt;view&gt;</span><br><span class="line">  &lt;view&gt;这是组件的内部节点&lt;/view&gt;</span><br><span class="line">  &lt;slot name=&quot;ulan&quot;&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;slot name=&quot;jintao&quot;&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">// index.wxml页面</span><br><span class="line">&lt;my-test&gt;</span><br><span class="line">  &lt;view&gt;这是插入到组件slot中的内容&lt;/view&gt;</span><br><span class="line">  &lt;view slot=&quot;ulan&quot;&gt;我是ulan&lt;/view&gt;</span><br><span class="line">  &lt;view slot=&quot;jintao&quot;&gt;我的朋友金涛&lt;/view&gt;</span><br><span class="line">&lt;/my-test&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="父子组件通信"><a href="#父子组件通信" class="headerlink" title="父子组件通信"></a>父子组件通信</h2><ol>
<li>父子组件通信的3种方式<ul>
<li>属性绑定：用于父组件向子组件的指定属性设置数据，仅能设置JSON兼容的数据</li>
<li>事件绑定：用于子组件向父组件传递数据，可以传递任意数据</li>
<li>获取组件实例：父组件通过this.selectComponent()获取子组件实例对象，可以直接访问子组件的任意数据和方法</li>
</ul>
</li>
<li>属性绑定<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// index页面的.js文件</span><br><span class="line">data: &#123;</span><br><span class="line">  count: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// index页面的.wxml文件，通过属性给my-test子组件传递数据</span><br><span class="line">&lt;view&gt;父组件的count值：&#123;&#123;count&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;my-test count=&quot;&#123;&#123;count&#125;&#125;&quot;&gt;&lt;/my-test&gt;</span><br><span class="line"></span><br><span class="line">// test子组件的.js文件，设置默认值9</span><br><span class="line">properties: &#123;</span><br><span class="line">  count: &#123;</span><br><span class="line">    type: Number,</span><br><span class="line">    value: 9</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// test子组件的.wxml文件，由于接受父组件传递的数据，这里count显示为0</span><br><span class="line">&lt;view&gt;子组件接受的count值：&#123;&#123;count&#125;&#125;&lt;/view&gt;</span><br></pre></td></tr></table></figure></li>
<li>事件绑定<ul>
<li>在父组件的js中，定义一个函数，这个函数即将通过自定义事件的形式，传递给子组件</li>
<li>在父组件的wxml中，通过自定义事件的形式，将步骤1中定义的函数引用，传递给子组件</li>
<li>在子组件的js中，通过调用<code>this.triggerEvent(&#39;自定义事件名称&#39;, &#123; 参数对象 &#125;)</code>，将数据发送到父组件</li>
<li>在父组件的js中，通过e.detail获取到子组件传递过来的数据<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// 第一步index.js</span><br><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    count: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  // 自定义事件，接收子组件传递过来的数据，并修改count</span><br><span class="line">  syncCount(e)&#123;</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      count: e.detail.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 第二步index.wxml，这个bind:sync表示自定义事件，名称叫sync</span><br><span class="line">&lt;view&gt;父组件的count值：&#123;&#123;count&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;my-test count=&quot;&#123;&#123;count&#125;&#125;&quot; bind:sync=&quot;syncCount&quot;&gt;&lt;/my-test&gt;</span><br><span class="line"></span><br><span class="line">// 第三步test.js</span><br><span class="line">Component(&#123;</span><br><span class="line">  properties: &#123;</span><br><span class="line">    count: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      value: 9</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 添加点击+1事件</span><br><span class="line">    addCount()&#123;</span><br><span class="line">      this.setData(&#123;</span><br><span class="line">        count: this.properties.count + 1</span><br><span class="line">      &#125;)</span><br><span class="line">      // 触发自定义事件，将数值同步给父组件</span><br><span class="line">      this.triggerEvent(&#x27;sync&#x27;, &#123; value: this.properties.count &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 第四步test.wxml，点击+1后，会修改count值，接着触发自定义事件</span><br><span class="line">&lt;view&gt;子组件接受的count值：&#123;&#123;count&#125;&#125;&lt;/view&gt;</span><br><span class="line">&lt;button type=&quot;default&quot; bindtap=&quot;addCount&quot;&gt;点击+1&lt;/button&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>获取组件实例：父组件调用<code>this.selectComponent(&quot;id或class选择器&quot;)</code>，获取子组件的实例对象，从而直接访问子组件的任意数据和方法。调用时需要传入一个选择器，例如<code>this.selectComponent(&quot;.customA&quot;)</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 父组件wxml</span><br><span class="line">&lt;my-test count=&quot;&#123;&#123;count&#125;&#125;&quot; bind:sync=&quot;syncCount&quot; class=&quot;customA&quot; id=&quot;cA&quot;&gt;&lt;/my-test&gt;</span><br><span class="line">&lt;button bindtap=&quot;getChild&quot;&gt;获取子组件实例&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">// 父组件js</span><br><span class="line">getChild()&#123;</span><br><span class="line">  const child = this.selectComponent(&#x27;#cA&#x27;)</span><br><span class="line">  child.setData(&#123;</span><br><span class="line">    // 如果写this会指向父组件，这次想修改子组件的count数据，要用child指向</span><br><span class="line">    count: child.properties.count + 1</span><br><span class="line">  &#125;)</span><br><span class="line">  // 调用子组件的addCount方法</span><br><span class="line">  child.addCount()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="behaviors组件代码共享"><a href="#behaviors组件代码共享" class="headerlink" title="behaviors组件代码共享"></a>behaviors组件代码共享</h2><ol>
<li>behaviors用于组件间代码共享，类似于vue中的mixins；每个behavior可以包含一组属性、数据、生命周期函数和方法，组件引用它时，它的属性、数据和方法会被合并到组件中<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 调用Behavior()方法，创建实例对象</span><br><span class="line">// 使用module.exports将behavior实例对象共享出去</span><br><span class="line">module.exports = Behavior(&#123;</span><br><span class="line">  // 属性节点</span><br><span class="line">  properties: &#123;&#125;,</span><br><span class="line">  // 私有数据节点</span><br><span class="line">  data: &#123; username: &#x27;幽蓝&#x27; &#125;,</span><br><span class="line">  // 事件处理函数和自定义方法节点</span><br><span class="line">  methods: &#123;&#125;,</span><br><span class="line">  // 其他节点......</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>导入behaviors到组件中<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// test.js</span><br><span class="line">const myBehavior = require(&#x27;../../behaviors/my-behavior&#x27;)</span><br><span class="line"></span><br><span class="line">Component(&#123;</span><br><span class="line">  behaviors: [myBehavior],</span><br><span class="line">  data: &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// test.wxml，这样就能使用username共享数据</span><br><span class="line">&lt;view&gt;在behavior中定义的用户名是：&#123;&#123;username&#125;&#125;&lt;/view&gt;</span><br></pre></td></tr></table></figure></li>
<li>behavior所有可用节点<ul>
<li>properties：同组件的属性</li>
<li>data：同组件的数据</li>
<li>methods：同自定义组件的方法</li>
<li>behaviors：引入其他的behavior</li>
<li>created：生命周期函数</li>
<li>attached：生命周期函数</li>
<li>ready：生命周期函数</li>
<li>moved：生命周期函数</li>
<li>detached：生命周期函数</li>
</ul>
</li>
<li>同名字段的覆盖和组合规则<ul>
<li>数据覆盖规则：组件 &gt; 父behavior &gt; 子behavior、靠后的behavior &gt; 靠前的behavior</li>
</ul>
</li>
</ol>
<h1 id="使用npm第三方包"><a href="#使用npm第三方包" class="headerlink" title="使用npm第三方包"></a>使用npm第三方包</h1><h2 id="npm包的限制"><a href="#npm包的限制" class="headerlink" title="npm包的限制"></a>npm包的限制</h2><ol>
<li>小程序支持使用npm安装第三方包，受限制影响能用的包其实很少，npm包有如下3个限制<ul>
<li>不支持依赖于Node.js内置库的包</li>
<li>不支持依赖于浏览器内置对象的包</li>
<li>不支持依赖于C++插件的包</li>
</ul>
</li>
</ol>
<h2 id="Vant-Weapp"><a href="#Vant-Weapp" class="headerlink" title="Vant Weapp"></a>Vant Weapp</h2><ol>
<li>Vant Weapp是有赞前端团队开源的一套小程序UI组件库，使用MIT开源许可协议，对商业使用比较友好</li>
</ol>
<p>未完待续…</p>
</article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/cover_weChat.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/reward_wechat.webp" target="_blank"><img class="post-qr-code-img" src="/img/reward_wechat.webp" alt="微信扫一扫"/></a><div class="post-qr-code-desc">微信扫一扫</div></li><li class="reward-item"><a href="/img/reward_alipay.webp" target="_blank"><img class="post-qr-code-img" src="/img/reward_alipay.webp" alt="支付宝扫一扫"/></a><div class="post-qr-code-desc">支付宝扫一扫</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/fce06ce7.html"><img class="prev-cover" src="/img/cover_vuePractise.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vue项目练习</div></div></a></div><div class="next-post pull-right"><a href="/archives/3c28277d.html"><img class="next-cover" src="/img/cover_uniApp.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">uni-app框架学习笔记</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NTk5My8zMjQ1Ng=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%89%B9%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">小程序特点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">常用组件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.</span> <span class="toc-text">样式介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#rpx%E5%B0%BA%E5%AF%B8%E5%8D%95%E4%BD%8D"><span class="toc-number">4.1.</span> <span class="toc-text">rpx尺寸单位</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%A0%B7%E5%BC%8F"><span class="toc-number">4.2.</span> <span class="toc-text">导入样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%A0%B7%E5%BC%8F"><span class="toc-number">4.3.</span> <span class="toc-text">全局样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E6%A0%B7%E5%BC%8F"><span class="toc-number">4.4.</span> <span class="toc-text">局部样式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9data%E5%80%BC"><span class="toc-number">5.</span> <span class="toc-text">修改data值</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">6.</span> <span class="toc-text">事件绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E4%BA%8B%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">常用事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E4%BC%A0%E5%8F%82"><span class="toc-number">6.2.</span> <span class="toc-text">事件传参</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E6%9C%AC%E6%95%B0%E6%8D%AE"><span class="toc-number">6.3.</span> <span class="toc-text">获取文本数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">7.</span> <span class="toc-text">条件渲染</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">8.</span> <span class="toc-text">列表渲染</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">9.</span> <span class="toc-text">全局配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#app-json"><span class="toc-number">9.1.</span> <span class="toc-text">app.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#window%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9"><span class="toc-number">9.2.</span> <span class="toc-text">window常用配置项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tabBar"><span class="toc-number">9.3.</span> <span class="toc-text">tabBar</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE"><span class="toc-number">10.</span> <span class="toc-text">页面配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82"><span class="toc-number">11.</span> <span class="toc-text">数据请求</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-number">11.1.</span> <span class="toc-text">网络数据请求的限制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E9%80%81get%E8%AF%B7%E6%B1%82"><span class="toc-number">11.2.</span> <span class="toc-text">发送get请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E9%80%81post%E8%AF%B7%E6%B1%82"><span class="toc-number">11.3.</span> <span class="toc-text">发送post请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E5%88%9A%E5%8A%A0%E8%BD%BD%E6%97%B6%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE"><span class="toc-number">11.4.</span> <span class="toc-text">页面刚加载时请求数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%B7%A8%E5%9F%9F%E5%92%8CAjax"><span class="toc-number">11.5.</span> <span class="toc-text">关于跨域和Ajax</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E5%AF%BC%E8%88%AA"><span class="toc-number">12.</span> <span class="toc-text">页面导航</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E5%AF%BC%E8%88%AA"><span class="toc-number">12.1.</span> <span class="toc-text">声明式导航</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%BC%8F%E5%AF%BC%E8%88%AA"><span class="toc-number">12.2.</span> <span class="toc-text">编程式导航</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E4%BC%A0%E5%8F%82"><span class="toc-number">12.3.</span> <span class="toc-text">导航传参</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6"><span class="toc-number">13.</span> <span class="toc-text">页面事件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0"><span class="toc-number">13.1.</span> <span class="toc-text">下拉刷新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E6%8B%89%E8%A7%A6%E5%BA%95"><span class="toc-number">13.2.</span> <span class="toc-text">上拉触底</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">14.</span> <span class="toc-text">生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%88%86%E7%B1%BB"><span class="toc-number">14.1.</span> <span class="toc-text">生命周期分类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6"><span class="toc-number">15.</span> <span class="toc-text">自定义组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E5%BC%95%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">15.1.</span> <span class="toc-text">组件的引用方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%92%8C%E9%A1%B5%E9%9D%A2%E7%9A%84%E4%B8%8D%E5%90%8C%E7%82%B9"><span class="toc-number">15.2.</span> <span class="toc-text">组件和页面的不同点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%A0%B7%E5%BC%8F%E9%9A%94%E7%A6%BB"><span class="toc-number">15.3.</span> <span class="toc-text">组件样式隔离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#data%E6%95%B0%E6%8D%AE%E3%80%81methods%E6%96%B9%E6%B3%95"><span class="toc-number">15.4.</span> <span class="toc-text">data数据、methods方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#properties%E6%8E%A5%E6%94%B6%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE"><span class="toc-number">15.5.</span> <span class="toc-text">properties接收传递数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#observers%E6%95%B0%E6%8D%AE%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-number">15.6.</span> <span class="toc-text">observers数据监听器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%AF%E6%95%B0%E6%8D%AE%E5%AD%97%E6%AE%B5"><span class="toc-number">15.7.</span> <span class="toc-text">纯数据字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">15.8.</span> <span class="toc-text">组件生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%89%80%E5%9C%A8%E7%9A%84%E9%A1%B5%E9%9D%A2%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">15.9.</span> <span class="toc-text">组件所在的页面生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%8F%92%E6%A7%BD"><span class="toc-number">15.10.</span> <span class="toc-text">组件插槽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-number">15.11.</span> <span class="toc-text">父子组件通信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#behaviors%E7%BB%84%E4%BB%B6%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB"><span class="toc-number">15.12.</span> <span class="toc-text">behaviors组件代码共享</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8npm%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8C%85"><span class="toc-number">16.</span> <span class="toc-text">使用npm第三方包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#npm%E5%8C%85%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-number">16.1.</span> <span class="toc-text">npm包的限制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vant-Weapp"><span class="toc-number">16.2.</span> <span class="toc-text">Vant Weapp</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: rgb(105, 105, 105)"><div id="footer-wrap"><div class="copyright">&copy;2022 By 幽蓝</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">The purpose of life is to enjoy every moment🍺</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>